this.JST=this.JST||{},this.JST["app/scripts/templates/av_context.html"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="debt-context-title">\n  <h3>Locations with a similar property tax base</h3>\n</div>\n<table>\n  <thead>\n    <tr>\n      <th></th>\n      <th>Property tax base (PTB)</th>\n      <th>Outstanding debt</th>\n      <th>Ratio of debt to PTB</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n';return __p},this.JST["app/scripts/templates/av_context_row.html"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+="<td>"+(null==(__t=issuer)?"":__t)+'</td>\n<td data-title="Property tax base (PTB)">'+(null==(__t=formatMoney(taxYearValuation))?"":__t)+'</td>\n<td data-title="Outstanding debt">'+(null==(__t=formatMoney(debtPrincipal))?"":__t)+'</td>\n<td data-title="Ratio of debt to PTB">'+(null==(__t=formatPercent(taxDebtToAssessedValuation))?"":__t)+"</td>\n";return __p},this.JST["app/scripts/templates/entity.html"]=function(obj){obj||(obj={});{var __t,__p="";_.escape,Array.prototype.join}with(obj)__p+=isISD?'\n  <div id="'+(null==(__t=issuerType)?"":__t)+'-jump" class="debt-box-title  '+(null==(__t=issuerType)?"":__t)+'">\n    <h2>'+(null==(__t=issuer)?"":__t)+'</h2>\n    <p class="pop">Students: '+(null==(__t=addCommas(students))?"":__t)+'</p>\n  </div>\n  <div class="explainer-box">\n    <p class="explainer-text">This Explorer provides data on the two most common kinds of debt that school districts issue: voter-approved debt, which is often used for capital projects such as building and renovations, and maintenance and operations debt, better known as M&amp;O debt, which can be used for administration and operational costs such as classroom equipment. This Explorer shows the district’s outstanding taxpayer-supported debt, the expected total interest to be paid on that debt, and the debt service, which is the sum of the debt and interest. It also looks at the district’s 2012 student population and the size of its property tax base to calculate the combined outstanding debt per student and the ratio of combined outstanding debt to property tax base.</p>\n    <p class="explainer-text">To provide context, this Explorer compares this '+(null==(__t=toDistrict(issuerType))?"":__t)+"'s combined outstanding debt to "+(null==(__t=plural(issuerType))?"":__t)+' with similar populations and property tax bases.</p>\n  </div>\n  <div class="data-box">\n    <table>\n      <tbody>\n        <tr>\n          <td>Voter-approved debt</td>\n          <td>'+(null==(__t=formatMoney(voterApprovedDebtPrincipal))?"":__t)+"</td>\n        </tr>\n        <tr>\n          <td>Interest</td>\n          <td>"+(null==(__t=formatMoney(voterApprovedDebtInterest))?"":__t)+"</td>\n        </tr>\n        <tr>\n          <td><strong>Total voter-approved debt service</strong></td>\n          <td><strong>"+(null==(__t=formatMoney(voterApprovedDebtService))?"":__t)+"</strong></td>\n        </tr>\n        <tr>\n          <td>Maintenance and operations debt (M&amp;O)</td>\n          <td>"+(null==(__t=formatMoney(mODebtPrincipal))?"":__t)+"</td>\n        </tr>\n        <tr>\n          <td>Interest</td>\n          <td>"+(null==(__t=formatMoney(mODebtInterest))?"":__t)+"</td>\n        </tr>\n        <tr>\n          <td><strong>Total M&amp;O debt service</strong></td>\n          <td><strong>"+(null==(__t=formatMoney(mODebtService))?"":__t)+'</strong></td>\n        </tr>\n        <tr class="important">\n          <td>Combined outstanding debt</td>\n          <td>'+(null==(__t=formatMoney(combinedDebt))?"":__t)+"</td>\n        </tr>\n        <tr>\n          <td>Debt per student</td>\n          <td>"+(null==(__t=formatMoney(debtPerStudent))?"":__t)+"\n          </td>\n        </tr>\n        <tr>\n          <td>Ratio of debt to property tax base</td>\n          <td>"+(null==(__t=formatPercent(totalDebtPerAV))?"":__t)+"</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n":'\n  <div id="'+(null==(__t=issuerType)?"":__t)+'-jump" class="debt-box-title '+(null==(__t=issuerType)?"":__t)+'">\n    <h2>'+(null==(__t=issuer)?"":__t)+'</h2>\n    <p class="pop">Pop. '+(null==(__t=addCommas(population))?"":__t)+'</p>\n  </div>\n  <div class="explainer-box">\n    <p class="explainer-text">This Explorer shows a '+(null==(__t=issuerType)?"":__t)+"'s outstanding taxpayer-supported debt, the expected total interest to be paid on that debt, and the debt service, which is the sum of the debt and interest. It also uses the "+(null==(__t=issuerType)?"":__t)+'\'s population and the size of its property tax base to calculate the outstanding debt per person and the ratio of outstanding debt to property tax base.</p>\n    <p class="explainer-text">To provide context, this Explorer compares this '+(null==(__t=toDistrict(issuerType))?"":__t)+"'s outstanding debt to "+(null==(__t=plural(issuerType))?"":__t)+' with similar populations and property tax bases.</p>\n  </div>\n  <div class="data-box">\n    <table>\n      <tbody>\n        <tr class="important">\n          <td>Outstanding debt</td>\n          <td>'+(null==(__t=formatMoney(debtPrincipal))?"":__t)+"</td>\n        </tr>\n        <tr>\n          <td>Interest</td>\n          <td>"+(null==(__t=formatMoney(debtInterest))?"":__t)+"</td>\n        </tr>\n        <tr>\n          <td>Debt service</td>\n          <td>"+(null==(__t=formatMoney(debtService))?"":__t)+" </td>\n        </tr>\n        <tr>\n          <td>Outstanding debt per person</td>\n          <td>"+(null==(__t=formatMoney(taxDebtPerCapita))?"":__t)+"\n          </td>\n        </tr>\n        <tr>\n          <td>Ratio of outstanding debt to property tax base</td>\n          <td>"+(null==(__t=formatPercent(taxDebtToAssessedValuation))?"":__t)+"</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n",__p+='\n<div class="debt-context">\n  <div class="debt-context-box">\n    <div class="debt-box-title '+(null==(__t=issuerType)?"":__t)+'">\n      <h3>Compare '+(null==(__t=issuer)?"":__t)+' to: </h3>\n    </div>\n    <div class="by-pop">\n      <div class="debt-context-title '+(null==(__t=issuerType)?"":__t)+'">\n        <h3>Locations with a similar population</h3>\n      </div>\n      <table>\n        <thead>\n          <tr>\n            <th>'+(null==(__t=issuerType)?"":__t)+'</th>\n            <th>Population</th>\n            <th>Outstanding Debt</th>\n            <th>Outstanding Debt per Person</th>\n          </tr>\n        </thead>\n        <tbody>\n        </tbody>\n      </table>\n    </div>\n    <div class="by-av">\n      <div class="debt-context-title '+(null==(__t=issuerType)?"":__t)+'">\n        <h3>Locations with a similar property tax base</h3>\n      </div>\n      <table>\n        <thead>\n          <tr>\n            <th>'+(null==(__t=issuerType)?"":__t)+"</th>\n            <th>Property Tax Base (PTB)</th>\n            <th>Outstanding Debt</th>\n            <th>Ratio of Outstanding Debt to PTB</th>\n          </tr>\n        </thead>\n        <tbody>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</div>\n\n";return __p},this.JST["app/scripts/templates/entity_layout.html"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="debt-box"></div>\n';return __p},this.JST["app/scripts/templates/go_to_button.html"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='<a href="#'+(null==(__t=issuerType)?"":__t)+'-jump" class="button '+(null==(__t=issuerType)?"":__t)+'">'+(null==(__t=issuer)?"":__t)+"</a>\n";return __p},this.JST["app/scripts/templates/go_to_buttons.html"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="form-prompt">\n  <p>Jump to view </p>\n</div>\n\n';return __p},this.JST["app/scripts/templates/isd_av_context.html"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="debt-context-title">\n  <h3>School districts with a similar property tax base</h3>\n</div>\n<table>\n  <thead>\n    <tr>\n      <th></th>\n      <th>Property tax dase (PTB)</th>\n      <th>Combined outstanding debt</th>\n      <th>Ratio of debt to PTB</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n';return __p},this.JST["app/scripts/templates/isd_av_context_row.html"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+="<td>"+(null==(__t=issuer)?"":__t)+'</td>\n<td data-title="Property tax dase (PTB)">'+(null==(__t=formatMoney(taxYearAssessedValuation))?"":__t)+'</td>\n<td data-title="Combined debt">'+(null==(__t=formatMoney(combinedDebt))?"":__t)+'</td>\n<td data-title="Ratio of debt to PTB">'+(null==(__t=formatPercent(totalDebtPerAV))?"":__t)+"</td>\n";return __p},this.JST["app/scripts/templates/population_context.html"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="debt-context-title">\n  <h3>Locations with a similar population</h3>\n</div>\n<table>\n  <thead>\n    <tr>\n      <th></th>\n      <th>Population</th>\n      <th>Outstanding debt</th>\n      <th>Outstanding debt per person</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n';return __p},this.JST["app/scripts/templates/population_context_row.html"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+="<td>"+(null==(__t=issuer)?"":__t)+'</td>\n<td data-title="Population">'+(null==(__t=addCommas(population))?"":__t)+'</td>\n<td data-title="Outstanding debt">'+(null==(__t=formatMoney(debtPrincipal))?"":__t)+'</td>\n<td data-title="Outstanding debt per person">'+(null==(__t=formatMoney(taxDebtPerCapita))?"":__t)+"</td>\n";return __p},this.JST["app/scripts/templates/search.html"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="search-box">\n  <form id="search-form">\n    <p class="form-prompt">Enter a Texas address or ZIP code</p>\n    <div class="form-group">\n      <label class="sr-only" for="address">Enter a Texas address or ZIP code</label>\n      <input type="text" id="address" placeholder="78701">\n    </div>\n    <button id="submit-search" class="search-submit" type="submit">Search</button>\n<!--     <span class="or-separator">- or -</span>\n    <button id="find-me" class="find-me">Find me</button> -->\n    <img src="/img/round-ajax-loader.gif" class="loading hide"/>\n    <div class="messages">\n      <div class="hide error" id="empty-error">\n        Please enter an address.\n      </div>\n      <div class="hide error" id="not-texas-error">\n        Sorry, you\'re not in Texas. Try entering a Texas address.\n      </div>\n    </div>\n  </form>\n</div>\n';return __p},this.JST["app/scripts/templates/search_message.html"]=function(obj){obj||(obj={});{var __t,__p="";_.escape,Array.prototype.join}with(obj)failed&&(__p+='\n<p class="error">\n  We couldn\'t find "<i>'+(null==(__t=q)?"":__t)+'</i>" in Texas. Try another search.\n</p>\n'),__p+="\n";return __p},this.JST["app/scripts/templates/students_context.html"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="debt-context-title">\n  <h3>School districts with a similar debt per student</h3>\n</div>\n<table>\n  <thead>\n    <tr>\n      <th></th>\n      <th>Student population</th>\n      <th>Combined outstanding debt</th>\n      <th>Debt per student</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n';return __p},this.JST["app/scripts/templates/students_context_row.html"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+="<td>"+(null==(__t=issuer)?"":__t)+'</td>\n<td data-title="Student population">'+(null==(__t=addCommas(students))?"":__t)+'</td>\n<td data-title="Combined debt">'+(null==(__t=formatMoney(combinedDebt))?"":__t)+'</td>\n<td data-title="Debt per student">'+(null==(__t=formatMoney(totalDebtPerStudent))?"":__t)+"</td>\n";return __p},window.app=new Marionette.Application,app.Collections=app.Collections||{},app.Controllers=app.Controllers||{},app.Layouts=app.Layouts||{},app.Mixins=app.Mixins||{},app.Models=app.Models||{},app.Routers=app.Routers||{},app.Views=app.Views||{},app.Settings={baseURL:""},app.addRegions({searchRegion:"#search",searchStringRegion:"#search-string",goToRegion:"#go-to-buttons",countyRegion:"#county-region",cityRegion:"#city-region",isdRegion:"#isd-region"}),app.addInitializer(function(){"use strict";var a=new app.Controllers.Main;a.index()}),$(document).ready(function(){"use strict";app.start()}),app.Mixins.Helpers={templateHelpers:function(){"use strict";var a="county"===this.model.get("issuerType"),b="isd"===this.model.get("issuerType"),c="city"===this.model.get("issuerType"),d=function(a){return"string"==typeof a||null===a?"N/A":"$"+a.toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},e=function(a){return"string"==typeof a||null===a?"N/A":(100*a).toFixed(2).toString()+"%"},f=function(a){return"isd"===a?"school district":a},g=function(a){return"string"==typeof a||null===a?"N/A":a.toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},h=function(a){return"isd"===a?"school districts":"county"===a?"counties":"cities"};return{isACounty:a,isISD:b,isACity:c,formatMoney:d,formatPercent:e,addCommas:g,toDistrict:f,plural:h}}},app.Controllers.Main=Marionette.Controller.extend({index:function(){"use strict";this.searchController=new app.Controllers.Search,this.listenTo(this.searchController,"location:found",this.locationFound)},locationFound:function(a){"use strict";var b,c=this;this.entities=new app.Collections.Entities,_.each(a.issuers,function(a){b=new app.Models.Entity(a.current),b.set("context",a.context),c.entities.push(b)}),this.renderButtons(),this.entities.each(function(a){"county"===a.get("issuerType")?c.renderCounty(a):"city"===a.get("issuerType")?c.renderCity(a):"isd"===a.get("issuerType")&&c.renderISD(a)})},renderCounty:function(a){"use strict";this.countyLayout=new app.Layouts.EntityLayout,app.countyRegion.show(this.countyLayout),this.countyLayout.debtBox.show(new app.Views.Entity({model:a})),this.countyLayout.debtByPop.show(new app.Views.PopulationContext({collection:new app.Collections.Entities(a.get("context").population)})),this.countyLayout.debtByAV.show(new app.Views.AVContext({collection:new app.Collections.Entities(a.get("context").assessedValuation)}))},renderCity:function(a){"use strict";this.cityLayout=new app.Layouts.EntityLayout,app.cityRegion.show(this.cityLayout),this.cityLayout.debtBox.show(new app.Views.Entity({model:a})),this.cityLayout.debtByPop.show(new app.Views.PopulationContext({collection:new app.Collections.Entities(a.get("context").population)})),this.cityLayout.debtByAV.show(new app.Views.AVContext({collection:new app.Collections.Entities(a.get("context").assessedValuation)}))},renderISD:function(a){"use strict";this.isdRegion=new app.Layouts.EntityLayout,app.isdRegion.show(this.isdRegion),this.isdRegion.debtBox.show(new app.Views.Entity({model:a})),this.isdRegion.debtByPop.show(new app.Views.StudentsContext({collection:new app.Collections.Entities(a.get("context").students)})),this.isdRegion.debtByAV.show(new app.Views.ISDAVContext({collection:new app.Collections.Entities(a.get("context").debtToAssessedValuation)}))},renderButtons:function(){"use strict";this.goToButtons=new app.Views.GoToButtons({collection:this.entities}),this.entities.length>0&&app.goToRegion.show(this.goToButtons)}}),app.Controllers.Search=Marionette.Controller.extend({initialize:function(){"use strict";this.baseURL=app.Settings.baseURL,this.searchView=new app.Views.Search,app.searchRegion.show(this.searchView),this.listenTo(this.searchView,"search:string",this.searchByString),this.listenTo(this.searchView,"search:location",this.searchByLocation)},searchByString:function(a){"use strict";var b=this;$.ajax({url:this.searchURL(a),dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpCallback",success:function(a){b.displaySearchString(a).trigger("location:found",a)}}).fail(function(){this.searchView.showNotTexasError()})},displaySearchString:function(a){"use strict";return this.searchMessageView=new app.Views.SearchMessage({model:new app.Models.SearchString(a.meta)}),app.searchStringRegion.show(this.searchMessageView),this},searchByLocation:function(){"use strict";var a,b;a=function(a){$.get(this.locationURL(a),function(a){this.trigger("location:found",a)})},b=function(){this.trigger("location:error","Geolocation is not working.")},"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(a,b)},locationURL:function(a){"use strict";var b=["lat="+a.coords.latitude,"lng="+a.coords.longitude].join("&");return this.baseURL+"/api/location?"+b},searchURL:function(a){"use strict";return this.baseURL+"/api/search?q="+a}}),app.Models.Entity=Backbone.Model.extend(),app.Models.SearchString=Backbone.Model.extend(),app.Collections.Entities=Backbone.Collection.extend({model:app.Models.Entity}),app.Views.Entity=Marionette.ItemView.extend({template:JST["app/scripts/templates/entity.html"],className:"debt-entity",onRender:function(){"use strict";this.$el.addClass(this.model.get("issuerType"))}}),_.extend(app.Views.Entity.prototype,app.Mixins.Helpers),app.Views.Entities=Marionette.CollectionView.extend({childView:app.Views.Entity,className:"prose"}),app.Views.GoToButton=Marionette.ItemView.extend({template:JST["app/scripts/templates/go_to_button.html"],className:"go-to-button"}),app.Views.GoToButtons=Marionette.CompositeView.extend({template:JST["app/scripts/templates/go_to_buttons.html"],childView:app.Views.GoToButton}),app.Views.Search=Marionette.ItemView.extend({template:JST["app/scripts/templates/search.html"],ui:{inputAddress:"input#address",emptyError:"#empty-error",notTexasError:"not-texas-error"},events:{"submit #search-form":"searchByAddress","change #address":"changeAddress","click #find-me":"findMe"},searchByAddress:function(a){"use strict";a.preventDefault();var b=$.trim(this.ui.inputAddress.val());this.hideErrors(),""===b?this.showEmptyError():this.trigger("search:string",b)},findMe:function(a){"use strict";a.preventDefault(),this.hideError(),this.trigger("search:location")},changeAddress:function(){"use strict";this.hideErrors()},showEmptyError:function(){"use strict";this.ui.emptyError.show()},showNotTexasError:function(){"use strict";this.ui.notTexasError.show()},hideErrors:function(){"use strict";this.ui.emptyError.hide(),this.ui.notTexasError.hide()}}),app.Views.PopulationContextRow=Marionette.ItemView.extend({template:JST["app/scripts/templates/population_context_row.html"],tagName:"tr"}),_.extend(app.Views.PopulationContextRow.prototype,app.Mixins.Helpers),app.Views.PopulationContext=Marionette.CompositeView.extend({template:JST["app/scripts/templates/population_context.html"],childView:app.Views.PopulationContextRow,childViewContainer:"tbody"}),app.Views.AVContextRow=Marionette.ItemView.extend({template:JST["app/scripts/templates/av_context_row.html"],tagName:"tr"}),_.extend(app.Views.AVContextRow.prototype,app.Mixins.Helpers),app.Views.AVContext=Marionette.CompositeView.extend({template:JST["app/scripts/templates/av_context.html"],childView:app.Views.AVContextRow,childViewContainer:"tbody"}),app.Views.StudentsContextRow=Marionette.ItemView.extend({template:JST["app/scripts/templates/students_context_row.html"],tagName:"tr"}),_.extend(app.Views.StudentsContextRow.prototype,app.Mixins.Helpers),app.Views.StudentsContext=Marionette.CompositeView.extend({template:JST["app/scripts/templates/students_context.html"],childView:app.Views.StudentsContextRow,childViewContainer:"tbody"}),app.Views.ISDAVContextRow=Marionette.ItemView.extend({template:JST["app/scripts/templates/isd_av_context_row.html"],tagName:"tr"}),_.extend(app.Views.ISDAVContextRow.prototype,app.Mixins.Helpers),app.Views.ISDAVContext=Marionette.CompositeView.extend({template:JST["app/scripts/templates/isd_av_context.html"],childView:app.Views.ISDAVContextRow,childViewContainer:"tbody"}),app.Views.SearchMessage=Marionette.ItemView.extend({template:JST["app/scripts/templates/search_message.html"],templateHelpers:function(){"use strict";return{failed:"error"===this.model.get("status")}}}),app.Layouts.EntityLayout=Backbone.Marionette.LayoutView.extend({template:JST["app/scripts/templates/entity_layout.html"],className:"debt-result",regions:{debtBox:".debt-box",debtContext:".debt-context",debtByPop:".by-pop",debtByAV:".by-av"}});